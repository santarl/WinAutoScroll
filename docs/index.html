<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WinAutoScroll</title>
    
    <!-- 1. PRELOAD COLOR TO PREVENT FLASH -->
    <script>
        (function() {
            try {
                const savedColor = localStorage.getItem('win98-bg');
                if (savedColor) {
                    document.write(`<style>body { background-color: ${savedColor} !important; }</style>`);
                }
            } catch(e) {}
        })();
    </script>

    <style>
        /* 1. Global Reset */
        * { box-sizing: border-box; }

        body { 
            background-color: #008080; /* Default: Classic Windows Teal */
            font-family: "MS Sans Serif", Tahoma, sans-serif; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
            padding: 20px;
            transition: background-color 0.3s;
        }
        
        /* Window Frame */
        .window { 
            width: 100%; 
            max-width: 900px; 
            background: #c0c0c0; 
            border-top: 2px solid #dfdfdf;
            border-left: 2px solid #dfdfdf;
            border-right: 2px solid #000;
            border-bottom: 2px solid #000;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.2); 
            display: flex;
            flex-direction: column;
        }

        /* Title Bar */
        .title-bar { 
            background: linear-gradient(90deg, #000080, #1084d0); 
            padding: 3px 2px 3px 3px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            flex-shrink: 0;
            margin: 2px;
        }
        .title-text { 
            color: white; 
            font-weight: bold; 
            font-size: 14px; 
            margin-left: 2px; 
            letter-spacing: 0.5px;
        }
        .btn-close { 
            background: #c0c0c0; 
            border-top: 1px solid #fff;
            border-left: 1px solid #fff;
            border-right: 1px solid #000;
            border-bottom: 1px solid #000;
            width: 16px; height: 14px; 
            font-size: 10px; line-height: 11px; 
            text-align: center; font-weight: bold; 
            cursor: pointer; 
            margin-right: 2px;
            box-shadow: 1px 1px 0 #000; 
        }
        .btn-close:active {
            border-top: 1px solid #000;
            border-left: 1px solid #000;
            border-right: 1px solid #fff;
            border-bottom: 1px solid #fff;
            box-shadow: none;
            transform: translate(1px, 1px);
        }

        /* Layout */
        .window-body {
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .header-container {
            display: flex;
            gap: 15px;
            align-items: flex-start;
            padding-bottom: 5px;
        }
        .icon-box { font-size: 42px; line-height: 1; }

        .content-row {
            display: flex;
            gap: 20px;
            align-items: stretch; 
        }
        
        .col-left { flex: 1.1; display: flex; flex-direction: column; gap: 15px; min-width: 0; }
        .col-right { flex: 0.9; display: flex; flex-direction: column; gap: 15px; min-width: 0; }

        /* Components */
        .group-box { 
            border: 2px solid; 
            border-color: #808080 #fff #fff #808080; 
            padding: 12px; 
            position: relative; 
            margin-top: 8px;
        }
        .group-label { 
            position: absolute; 
            top: -10px; left: 10px; 
            background: #c0c0c0; 
            padding: 0 5px; 
        }

        /* Buttons */
        .btn { 
            background: #c0c0c0; 
            border-top: 1px solid #fff;
            border-left: 1px solid #fff;
            border-right: 2px solid #000;
            border-bottom: 2px solid #000;
            box-shadow: 1px 1px 0 #000;
            padding: 6px 20px; 
            color: black; 
            text-decoration: none; 
            font-size: 13px; 
            display: inline-block; 
            cursor: pointer; 
            text-align: center;
            min-width: 90px;
            position: relative;
        }
        .btn:hover::after {
            content: '';
            position: absolute;
            top: 4px; left: 4px; right: 4px; bottom: 4px;
            border: 1px dotted #000;
            pointer-events: none;
        }
        .btn:active { 
            border-top: 2px solid #000;
            border-left: 2px solid #000;
            border-right: 1px solid #fff;
            border-bottom: 1px solid #fff;
            box-shadow: none;
            transform: translate(1px, 1px); 
        }
        .btn:active::after { display: none; }
        .btn-primary { font-weight: bold; }

        /* Badges */
        .badges { 
            margin-top: 8px; 
            display: flex; 
            flex-wrap: wrap; 
            gap: 5px; 
            align-items: center;
        }
        .badges img { height: 22px; max-width: 100%; }
        
        ul { padding-left: 20px; margin: 5px 0; font-size: 12px; }
        li { margin-bottom: 4px; }
        p { margin: 0; font-size: 12px; }

        pre { 
            background: white; 
            border: 2px solid; 
            border-color: #000 #fff #fff #000; 
            padding: 8px; 
            font-family: "Consolas", "Courier New", monospace; 
            font-size: 11px;
            overflow-x: auto; 
            margin: 5px 0 0 0;
            white-space: pre-wrap; 
            word-wrap: break-word;
        }

        .footer-container {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 5px;
            flex-wrap: wrap;
        }

        .video-placeholder {
            width: 100%;
            background: black;
            border: 2px solid;
            border-color: #808080 #fff #fff #808080;
            aspect-ratio: 16/9;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #808080;
            font-weight: bold;
            position: relative;
            margin-top: 8px;
        }
        .video-text {
            border: 1px dashed #444;
            padding: 20px;
            border-radius: 4px;
        }

        .fill-remaining {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between; 
        }

        .mobile-only { display: none; }
        .desktop-only { display: inline-block; }

        @media (max-width: 850px) {
            .content-row { display: contents; }
            .col-left, .col-right { display: contents; }
            .window-body { display: flex; flex-direction: column; }

            .header-container   { order: 1; text-align: center; flex-direction: column; align-items: center; }
            #box-description    { order: 2; }
            .video-placeholder  { order: 3; margin-bottom: 10px; margin-top: 0; }
            #box-features       { order: 4; }
            #box-portable       { order: 5; }
            #box-compilation    { order: 6; }
            .footer-container   { order: 7; justify-content: center; margin-top: 20px; flex-direction: column; }

            .fill-remaining { flex-grow: 0; }
            .mobile-only { display: block; margin-top: 10px; width: 100%; }
            .desktop-only { display: none !important; }
            .badges { justify-content: center; }
            .btn { display: block; width: 100%; margin: 0 0 10px 0; } 
            .footer-container .btn { margin-right: 0; }
        }
    </style>
</head>
<body>
    <div class="window">
        <div class="title-bar">
            <div class="title-text">WinAutoScroll Properties</div>
            <div class="btn-close" id="egg-trigger" title="Change Background">X</div>
        </div>
        
        <div class="window-body">
            <!-- HEADER -->
            <div class="header-container">
                <div class="icon-box">üñ±Ô∏è</div>
                <div>
                    <h2 style="margin: 0; font-size: 20px;">WinAutoScroll</h2>
                    <!-- Version will be loaded by JS -->
                    <p style="margin: 2px 0; color: #444;"><span id="app-version">Loading...</span></p>
                    <div class="badges">
                        <!-- Dynamic Stats (Pantry) -->
                        <img src="https://img.shields.io/badge/dynamic/json?url=https://getpantry.cloud/apiv1/pantry/780d7b02-555b-4678-98e4-d438ea0c9397/basket/WinAutoScroll&query=$.pixels&label=total%20pixels%20scrolled&color=red&style=for-the-badge">
                        <img src="https://img.shields.io/badge/dynamic/json?url=https://getpantry.cloud/apiv1/pantry/780d7b02-555b-4678-98e4-d438ea0c9397/basket/WinAutoScroll&query=$.kilometres&label=total%20kilometres%20scrolled&color=blueviolet&style=for-the-badge">
                        
                        <!-- Meta Badges (Updated by JS or Fallback) -->
                        <img id="badge-version" src="https://img.shields.io/github/v/release/santarl/WinAutoScroll?label=version&color=orange&style=for-the-badge" alt="Version">
                        <img src="https://img.shields.io/github/release-date/santarl/WinAutoScroll?label=updated&style=for-the-badge&color=yellow" alt="Last Updated">
                        
                        <!-- Activity (Hidden if NoScript) -->
                        <img id="badge-commits" style="display:none;" alt="Commits Since">
                        
                        <img src="https://img.shields.io/github/last-commit/santarl/WinAutoScroll?label=last%20commit&style=for-the-badge&color=green" alt="Last Commit">
                        
                        <!-- Static Fallback Size -->
                        <img id="badge-size" src="https://img.shields.io/badge/binary_size-~24KB-lightgrey?style=for-the-badge" alt="Size">
                        
                        <img src="https://img.shields.io/badge/platform-windows-blue?style=for-the-badge" alt="Platform">
                        <img src="https://img.shields.io/badge/license-GPLv3-lightgrey?style=for-the-badge" alt="License">
                    </div>
                </div>
            </div>

            <!-- CONTENT ROW -->
            <div class="content-row">
                <div class="col-left">
                    <!-- Description -->
                    <div class="group-box" id="box-description">
                        <div class="group-label">Description</div>
                        <p style="margin-top: 5px;">A lightweight, dependency-free utility that adds universal middle-click auto-scrolling to any Windows application.</p>
                    </div>

                    <!-- Features -->
                    <div class="group-box" id="box-features">
                        <div class="group-label">Features</div>
                        <ul style="margin-bottom: 0; margin-top: 5px;">
                            <li><strong>Zero Idle CPU:</strong> Uses efficient OS-level event monitoring. The scrolling engine remains completely suspended until triggered.</li>
                            <li><strong>Universal:</strong> Works in Discord, Spotify, Text Editors, and everywhere, even legacy Win32 apps!</li>
                            <li><strong>Native Visuals:</strong> Smooth GDI+ overlay and dynamic cursors.</li>
                            <li><strong>Configurable:</strong> Edit sensitivity, dead-zones, colors and many more properties via <code>config.ini</code>.</li>
                            <li><strong>Gamification:</strong> Track your scroll distance, most scrolled direction and optionally contribute to the community counter (leaderboards ü§î).</li>
                        </ul>
                    </div>

                    <!-- Portable Usage -->
                    <div class="group-box fill-remaining" id="box-portable">
                        <div class="group-label">Portable Usage</div>
                        <p style="margin-top: 5px; margin-bottom: 8px;">No installation required.<br>Just download the executable and config file to any folder and run.</p>
                        
                        <a href="https://github.com/santarl/WinAutoScroll/releases/latest" class="btn btn-primary mobile-only">Download</a>
                    </div>
                </div>

                <div class="col-right">
                    <!-- Video -->
                    <div class="video-placeholder">
                        <div class="video-text">[ VIDEO PREVIEW ]</div>
                    </div>
                    
                    <!-- Tech Demo Link -->
                    <div style="text-align:center; margin-top: 5px;">
                        <a href="game.html" class="btn" style="width:100%">Run Tech Demo / Calibrator</a>
                    </div>

                    <!-- Compilation -->
                    <div class="group-box fill-remaining" id="box-compilation">
                        <div class="group-label">Compilation</div>
                        <p style="margin-top: 0; margin-bottom: 5px;">Open a <strong>Visual Studio Developer Command Prompt</strong> and run:</p>
                        <pre>git clone https://github.com/santarl/WinAutoScroll
cd WinAutoScroll
cl WinAutoScroll.cpp /MD /O2 /link /SUBSYSTEM:WINDOWS</pre>
                    </div>
                </div>
            </div>

            <!-- FOOTER -->
            <div class="footer-container">
                <a href="https://github.com/santarl/WinAutoScroll/issues" class="btn">Report Bug</a>
                <a href="https://github.com/santarl/WinAutoScroll" class="btn">Source Code</a>
                <a href="https://github.com/santarl/WinAutoScroll/releases/latest" class="btn btn-primary desktop-only">Download</a>
            </div>
        </div>
    </div>

    <script>
        // 1. Smart Cache for GitHub Stats
        async function fetchRepoStats() {
            const CACHE_KEY = 'was_stats_cache';
            const ONE_WEEK = 7 * 24 * 60 * 60 * 1000;

            const updateUI = (version, sizeKB) => {
                if (document.getElementById('app-version')) {
                    document.getElementById('app-version').innerText = version;
                }
                
                if (document.getElementById('badge-version')) {
                    document.getElementById('badge-version').src = 
                        `https://img.shields.io/badge/version-${version}-orange?style=for-the-badge`;
                }
                
                if (document.getElementById('badge-size')) {
                    const sizeEncoded = sizeKB.replace(" ", "%20");
                    document.getElementById('badge-size').src = 
                        `https://img.shields.io/badge/binary_size-${sizeEncoded}-red?style=for-the-badge`;
                }

                const commitsBadge = document.getElementById('badge-commits');
                if (commitsBadge && version) {
                    commitsBadge.src = `https://img.shields.io/github/commits-since/santarl/WinAutoScroll/${version}?label=commits%20since%20release&style=for-the-badge&color=blue`;
                    commitsBadge.style.display = "inline";
                }
            };

            try {
                const cached = localStorage.getItem(CACHE_KEY);
                if (cached) {
                    const { version, size, timestamp } = JSON.parse(cached);
                    if (Date.now() - timestamp < ONE_WEEK) {
                        updateUI(version, size);
                        return; 
                    }
                }

                const response = await fetch('https://api.github.com/repos/santarl/WinAutoScroll/releases/latest');
                if (!response.ok) return;
                
                const data = await response.json();
                const version = data.tag_name || "v1"; 
                const exeAsset = data.assets.find(a => a.name.endsWith('.exe'));
                let sizeKB = "~30KB"; 

                if (exeAsset) {
                    sizeKB = (exeAsset.size / 1024).toFixed(1) + " KB";
                }

                updateUI(version, sizeKB);

                localStorage.setItem(CACHE_KEY, JSON.stringify({
                    version: version,
                    size: sizeKB,
                    timestamp: Date.now()
                }));

            } catch (e) {
                console.log("GitHub API Error (using static fallbacks)", e);
            }
        }
        fetchRepoStats();

        // 2. Easter Egg Logic
        const bgColors = [
            '#008080', '#3B6EA5', '#000000', '#800000', '#2F4F4F', '#000080'
        ];
        let colorIndex = 0;

        const saved = localStorage.getItem('win98-bg');
        if (saved) {
            const idx = bgColors.indexOf(saved);
            if (idx > -1) colorIndex = idx;
        }

        document.getElementById('egg-trigger').onclick = function() {
            colorIndex = (colorIndex + 1) % bgColors.length;
            const newColor = bgColors[colorIndex];
            document.body.style.setProperty('background-color', newColor, 'important');
            localStorage.setItem('win98-bg', newColor);
        };
    </script>
</body>
</html>